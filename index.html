<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>KenyonCore</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
:root{--accent:#1B3A6B;--accent-hover:#24508F;--accent-light:#E8EEF6;--navy-900:#1B2A4A;--navy-800:#243558;--gray-900:#1A1D26;--gray-800:#2A2E3A;--gray-700:#3D4255;--gray-600:#555B6E;--gray-500:#6E7489;--gray-400:#9197AB;--gray-300:#B8BDD0;--gray-200:#D6DAE5;--gray-100:#ECEEF4;--gray-50:#F5F6FA;--white:#FFFFFF;--green-600:#16A34A;--green-100:#DCFCE7;--red-600:#DC2626;--red-100:#FEE2E2;--blue-600:#2563EB;--blue-100:#DBEAFE;--yellow-500:#EAB308;--yellow-100:#FEF9C3;--radius-sm:6px;--radius-md:8px;--radius-lg:12px;--shadow-sm:0 1px 2px rgba(27,42,74,.06);--shadow-md:0 4px 12px rgba(27,42,74,.08);--shadow-lg:0 8px 30px rgba(27,42,74,.12);--transition:150ms cubic-bezier(.4,0,.2,1)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',-apple-system,sans-serif;background:var(--gray-50);color:var(--gray-900);min-height:100vh}
.topnav{background:var(--navy-900);height:56px;display:flex;align-items:center;padding:0 24px;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,.2)}
.topnav-logo{display:flex;align-items:center;gap:10px;color:#fff;font-weight:700;font-size:18px;letter-spacing:-.5px}
.topnav-center{flex:1;display:flex;justify-content:center;gap:4px}
.topnav-tab{color:var(--gray-400);padding:8px 16px;border-radius:var(--radius-sm);font-size:13px;font-weight:500;cursor:pointer;transition:var(--transition);border:none;background:none}
.topnav-tab:hover{color:var(--gray-200);background:rgba(255,255,255,.06)}
.topnav-tab.active{color:#fff;background:rgba(255,255,255,.1)}
.topnav-right{display:flex;align-items:center;gap:12px}
.page-header{background:#fff;border-bottom:1px solid var(--gray-200);padding:20px 32px}
.page-header-inner{max-width:1400px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}
.page-title-group{display:flex;align-items:center;gap:12px}
.page-title{font-size:22px;font-weight:700;color:var(--gray-900);letter-spacing:-.5px}
.badge{font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px;text-transform:uppercase;letter-spacing:.5px}
.badge-draft{background:var(--yellow-100);color:#92400E}
.badge-active{background:var(--green-100);color:#166534}
.page-actions{display:flex;gap:8px}
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 16px;border-radius:var(--radius-sm);font-family:inherit;font-size:13px;font-weight:600;cursor:pointer;transition:var(--transition);border:none;white-space:nowrap}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:var(--accent-hover);transform:translateY(-1px);box-shadow:0 4px 12px rgba(27,58,107,.3)}
.btn-secondary{background:#fff;color:var(--gray-700);border:1px solid var(--gray-300)}
.btn-secondary:hover{background:var(--gray-50);border-color:var(--gray-400)}
.btn-sm{padding:5px 10px;font-size:12px}
.btn-icon{width:34px;height:34px;padding:0;display:inline-flex;align-items:center;justify-content:center;border-radius:var(--radius-sm);background:#fff;border:1px solid var(--gray-200);color:var(--gray-500);cursor:pointer;transition:var(--transition)}
.btn-icon:hover{background:var(--gray-50);color:var(--gray-900);border-color:var(--gray-400)}
.main-content{max-width:1400px;margin:0 auto;padding:24px 32px 60px;display:grid;grid-template-columns:340px 1fr;gap:24px}
@media(max-width:1024px){.main-content{grid-template-columns:1fr}}
.card{background:#fff;border:1px solid var(--gray-200);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);overflow:hidden}
.card-header{padding:16px 20px;border-bottom:1px solid var(--gray-100);display:flex;align-items:center;justify-content:space-between}
.card-title{font-size:14px;font-weight:700;color:var(--gray-800);text-transform:uppercase;letter-spacing:.5px}
.card-body{padding:16px 20px}
.sidebar{display:flex;flex-direction:column;gap:20px}
.form-group{margin-bottom:14px}.form-group:last-child{margin-bottom:0}
.form-label{display:block;font-size:12px;font-weight:600;color:var(--gray-600);margin-bottom:5px;text-transform:uppercase;letter-spacing:.4px}
.form-input{width:100%;padding:9px 12px;border:1px solid var(--gray-200);border-radius:var(--radius-sm);font-family:inherit;font-size:14px;color:var(--gray-900);background:#fff;transition:var(--transition)}
.form-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(27,58,107,.1)}
.form-input-mono{font-family:'JetBrains Mono',monospace;font-size:13px}
.rate-row{display:flex;align-items:center;padding:10px 0;border-bottom:1px solid var(--gray-100);gap:10px}
.rate-row:last-child{border-bottom:none}
.rate-check{width:18px;height:18px;accent-color:var(--accent);cursor:pointer;flex-shrink:0}
.rate-label{font-size:13px;font-weight:500;color:var(--gray-800);flex:1;min-width:70px}
.rate-input{width:90px;padding:6px 8px;border:1px solid var(--gray-200);border-radius:var(--radius-sm);font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--gray-900);text-align:right;transition:var(--transition)}
.rate-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(27,58,107,.1)}
.rate-unit{font-size:11px;color:var(--gray-500);white-space:nowrap}
.phase-table{width:100%;border-collapse:collapse}
.phase-table th{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--gray-500);padding:10px 12px;text-align:left;background:var(--gray-50);border-bottom:1px solid var(--gray-200)}
.phase-table td{padding:8px 12px;border-bottom:1px solid var(--gray-100);vertical-align:middle}
.phase-table tr:hover td{background:var(--gray-50)}
.phase-table .phase-name-input{border:1px solid transparent;padding:6px 8px;border-radius:var(--radius-sm);font-family:inherit;font-size:14px;font-weight:500;color:var(--gray-900);width:100%;background:transparent;transition:var(--transition)}
.phase-table .phase-name-input:hover{border-color:var(--gray-200);background:var(--gray-50)}
.phase-table .phase-name-input:focus{border-color:var(--accent);outline:none;background:#fff;box-shadow:0 0 0 3px rgba(27,58,107,.1)}
.phase-table .phase-yards-input{border:1px solid transparent;padding:6px 8px;border-radius:var(--radius-sm);font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--gray-900);width:100px;text-align:right;background:transparent;transition:var(--transition)}
.phase-table .phase-yards-input:hover{border-color:var(--gray-200);background:var(--gray-50)}
.phase-table .phase-yards-input:focus{border-color:var(--accent);outline:none;background:#fff;box-shadow:0 0 0 3px rgba(27,58,107,.1)}
.phase-drag-handle{cursor:grab;color:var(--gray-400);font-size:14px;padding:4px;user-select:none}
.phase-drag-handle:active{cursor:grabbing}
tr.dragging{opacity:.4;background:var(--accent-light)}
tr.drag-over td{border-top:2px solid var(--accent);padding-top:6px}
.phase-number{width:24px;height:24px;border-radius:50%;background:var(--navy-800);color:#fff;font-size:11px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.schedule-table{width:100%;border-collapse:collapse}
.schedule-table th{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--gray-500);padding:10px 14px;text-align:left;background:var(--gray-50);border-bottom:2px solid var(--gray-200);position:sticky;top:0}
.schedule-table td{padding:9px 14px;border-bottom:1px solid var(--gray-100);font-size:13px}
.schedule-table tr:hover td{background:rgba(27,58,107,.03)}
.schedule-table .phase-group td{background:var(--gray-50);font-weight:700;font-size:12px;text-transform:uppercase;letter-spacing:.3px;color:var(--gray-700);border-bottom:1px solid var(--gray-200)}
.schedule-table .phase-total td{background:var(--accent-light);font-weight:700;font-size:12px;color:var(--navy-900);border-top:2px solid var(--accent);border-bottom:2px solid var(--accent)}
.task-badge{display:inline-flex;align-items:center;gap:6px;font-size:13px;font-weight:500}
.task-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.task-dot-scaffold{background:var(--navy-800)}.task-dot-lath{background:var(--blue-600)}.task-dot-scratch{background:var(--accent)}.task-dot-cure{background:var(--gray-400)}.task-dot-brown{background:var(--yellow-500)}.task-dot-finish{background:var(--green-600)}
.mono{font-family:'JetBrains Mono',monospace;font-size:12px}.text-right{text-align:right}.text-muted{color:var(--gray-500)}
.gantt-container{overflow-x:auto;padding:16px 20px 20px}
.gantt-header-row{display:flex;border-bottom:1px solid var(--gray-200);margin-bottom:2px;padding-left:180px}
.gantt-date-label{font-size:10px;font-weight:600;color:var(--gray-500);text-transform:uppercase;letter-spacing:.3px;text-align:center;border-left:1px solid var(--gray-100);padding:4px 0}
.gantt-row{display:flex;align-items:center;min-height:30px;position:relative}
.gantt-label{width:180px;flex-shrink:0;font-size:12px;font-weight:500;color:var(--gray-700);padding-right:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.gantt-track{flex:1;position:relative;height:22px}
.gantt-bar{position:absolute;height:20px;border-radius:4px;top:1px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;color:#fff;min-width:4px;transition:opacity 150ms;cursor:default}
.gantt-bar:hover{opacity:.85}
.gantt-bar-scaffold{background:var(--navy-800)}.gantt-bar-lath{background:var(--blue-600)}.gantt-bar-scratch{background:var(--accent)}.gantt-bar-cure{background:repeating-linear-gradient(45deg,var(--gray-300),var(--gray-300) 3px,var(--gray-400) 3px,var(--gray-400) 6px);color:var(--gray-700)}.gantt-bar-brown{background:var(--yellow-500);color:var(--gray-900)}.gantt-bar-finish{background:var(--green-600)}
.gantt-phase-header{font-size:11px;font-weight:700;color:var(--gray-700);text-transform:uppercase;letter-spacing:.3px;padding:10px 0 4px;border-bottom:1px solid var(--gray-100);margin-top:4px}
.view-tabs{display:flex;gap:2px;background:var(--gray-100);padding:3px;border-radius:var(--radius-md);width:fit-content}
.view-tab{padding:7px 16px;font-size:13px;font-weight:600;border:none;border-radius:var(--radius-sm);cursor:pointer;transition:var(--transition);background:transparent;color:var(--gray-600);font-family:inherit}
.view-tab.active{background:#fff;color:var(--gray-900);box-shadow:var(--shadow-sm)}
.view-tab:hover:not(.active){color:var(--gray-800)}
.tab-content{display:none}.tab-content.active{display:block}
.stats-row{display:flex;gap:12px;flex-wrap:wrap}
.stat-card{flex:1;min-width:120px;background:var(--gray-50);border:1px solid var(--gray-100);border-radius:var(--radius-md);padding:14px 16px}
.stat-value{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700;color:var(--gray-900);line-height:1;margin-bottom:4px}
.stat-label{font-size:11px;font-weight:600;color:var(--gray-500);text-transform:uppercase;letter-spacing:.4px}
.tooltip{position:absolute;background:var(--gray-900);color:#fff;padding:8px 12px;border-radius:var(--radius-sm);font-size:12px;pointer-events:none;z-index:200;box-shadow:var(--shadow-lg);white-space:nowrap;display:none}
.empty-state{text-align:center;padding:48px 24px;color:var(--gray-500)}
.empty-state-icon{font-size:48px;margin-bottom:12px;opacity:.5}
.empty-state-text{font-size:14px;font-weight:500}
.empty-state-sub{font-size:13px;color:var(--gray-400);margin-top:6px}
.modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(26,29,38,.5);backdrop-filter:blur(4px);z-index:500;align-items:center;justify-content:center}
.modal-overlay.open{display:flex}
.modal{background:#fff;border-radius:var(--radius-lg);box-shadow:0 20px 60px rgba(0,0,0,.25);width:520px;max-width:95vw;max-height:90vh;overflow-y:auto;animation:modalIn 200ms ease-out}
@keyframes modalIn{from{opacity:0;transform:scale(.95) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
.modal-header{padding:20px 24px 16px;border-bottom:1px solid var(--gray-100);display:flex;align-items:center;justify-content:space-between}
.modal-title{font-size:18px;font-weight:700;color:var(--gray-900)}
.modal-close{width:32px;height:32px;border:none;background:var(--gray-100);border-radius:50%;cursor:pointer;font-size:16px;color:var(--gray-600);display:flex;align-items:center;justify-content:center;transition:var(--transition)}
.modal-close:hover{background:var(--gray-200);color:var(--gray-900)}
.modal-body{padding:20px 24px}
.modal-footer{padding:16px 24px 20px;border-top:1px solid var(--gray-100);display:flex;justify-content:flex-end;gap:8px}
.export-section{margin-bottom:20px}.export-section:last-child{margin-bottom:0}
.export-section-title{font-size:12px;font-weight:700;color:var(--gray-600);text-transform:uppercase;letter-spacing:.5px;margin-bottom:10px}
.export-option-group{display:flex;gap:8px}
.export-option{flex:1;padding:12px 14px;border:2px solid var(--gray-200);border-radius:var(--radius-md);cursor:pointer;transition:var(--transition);text-align:center;background:#fff}
.export-option:hover{border-color:var(--gray-300);background:var(--gray-50)}
.export-option.selected{border-color:var(--accent);background:var(--accent-light)}
.export-option-icon{font-size:24px;margin-bottom:4px}
.export-option-label{font-size:13px;font-weight:600;color:var(--gray-800)}
.export-option-sub{font-size:11px;color:var(--gray-500);margin-top:2px}
.column-toggle-list{display:flex;flex-direction:column;gap:6px}
.column-toggle{display:flex;align-items:center;gap:10px;padding:8px 12px;border:1px solid var(--gray-100);border-radius:var(--radius-sm);cursor:pointer;transition:var(--transition)}
.column-toggle:hover{background:var(--gray-50)}
.column-toggle input{width:16px;height:16px;accent-color:var(--accent);cursor:pointer}
.column-toggle label{font-size:13px;font-weight:500;color:var(--gray-800);cursor:pointer;flex:1}
.column-toggle .col-preview{font-size:11px;color:var(--gray-400);font-style:italic}
.gantt-toggle{display:flex;align-items:center;gap:10px;padding:10px 12px;border:1px solid var(--gray-200);border-radius:var(--radius-sm);margin-top:10px}
.gantt-toggle input{width:16px;height:16px;accent-color:var(--accent);cursor:pointer}
.gantt-toggle label{font-size:13px;font-weight:500;color:var(--gray-800);cursor:pointer}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
.animate-in{animation:fadeIn 300ms cubic-bezier(.4,0,.2,1) forwards}
.misc-item{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.misc-item input[type="text"]{flex:1;padding:6px 8px;border:1px solid var(--gray-200);border-radius:var(--radius-sm);font-family:inherit;font-size:13px;transition:var(--transition)}
.misc-item input[type="text"]:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(27,58,107,.1)}
.misc-item .misc-val{width:110px;font-family:'JetBrains Mono',monospace;font-size:12px;text-align:right;padding-left:20px}
.misc-item .misc-dollar{position:relative}
.misc-item .misc-dollar span{position:absolute;left:6px;top:50%;transform:translateY(-50%);color:var(--gray-400);font-size:12px}
.misc-remove{width:24px;height:24px;border:none;background:var(--gray-100);border-radius:50%;cursor:pointer;color:var(--gray-500);font-size:12px;display:flex;align-items:center;justify-content:center;transition:var(--transition);flex-shrink:0}
.misc-remove:hover{background:var(--red-100);color:var(--red-600)}
.sov-elev-value{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--gray-900);font-weight:500}
.sov-pct{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--gray-600)}
::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--gray-300);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--gray-400)}

/* â”€â”€â”€ MOBILE â”€â”€â”€ */
@media(max-width:768px){
.topnav{padding:0 12px;gap:4px;height:auto;min-height:56px;flex-wrap:wrap;padding-bottom:8px}
.topnav-logo{font-size:16px}
.topnav-center{order:3;width:100%;justify-content:center;gap:2px;padding-top:4px}
.topnav-tab{padding:6px 12px;font-size:12px}
.topnav-right{margin-left:auto}
.topnav-right .btn-sm{padding:4px 8px;font-size:11px}
.page-header{padding:14px 16px}
.page-header-inner{gap:10px}
.page-title{font-size:18px}
.page-actions{gap:6px}
.page-actions .btn{padding:7px 10px;font-size:12px}
.main-content{padding:16px 12px 40px;gap:16px}
.card-body{padding:12px 14px}
.card-header{padding:12px 14px}
.sidebar{gap:14px}
.stats-row{gap:8px}
.stat-card{padding:10px 12px;min-width:90px}
.stat-value{font-size:18px}
.phase-table td,.phase-table th{padding:6px 8px}
.phase-table .phase-name-input{font-size:13px;padding:5px 6px}
.phase-table .phase-yards-input{width:80px;font-size:12px;padding:5px 6px}
.schedule-table td,.schedule-table th{padding:7px 8px;font-size:12px}
.form-group{margin-bottom:10px}
.rate-row{padding:8px 0;gap:6px}
.rate-input{width:70px;padding:5px 6px;font-size:12px}
.rate-label{font-size:12px}
.modal{width:95vw;max-height:85vh}
.modal-body{padding:14px 16px}
.export-option{padding:10px 8px}
.export-option-icon{font-size:20px}
.export-option-label{font-size:12px}
.view-tabs{width:100%}
.view-tab{flex:1;text-align:center;padding:6px 8px;font-size:12px}
}
</style>
</head>
<body>
<nav class="topnav">
<div class="topnav-logo"><img src="data:image/png;base64,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" alt="Kenyon Construction" style="height:24px;"/><span style="color:var(--gray-300);font-size:14px;font-weight:400;opacity:.6">Core</span></div>
<div class="topnav-center">
<button class="topnav-tab active" onclick="switchPage('schedule')">Schedule</button>
<button class="topnav-tab" onclick="switchPage('sov')">SOV</button>
</div>
<div class="topnav-right">
<button class="btn-icon" id="undo-btn" onclick="undo()" title="Undo (Ctrl+Z)" style="border-color:rgba(255,255,255,.15);color:var(--gray-400);background:transparent;opacity:.35">â†©</button>
<button class="btn-icon" id="redo-btn" onclick="redo()" title="Redo (Ctrl+Y)" style="border-color:rgba(255,255,255,.15);color:var(--gray-400);background:transparent;opacity:.35">â†ª</button>
<button class="btn btn-sm btn-secondary" style="border-color:rgba(255,255,255,.15);color:var(--gray-300);" onclick="openExportModal()">â¬‡ Export</button>
</div>
</nav>
<div id="page-schedule">
<div class="page-header"><div class="page-header-inner">
<div class="page-title-group"><img src="data:image/png;base64,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" alt="Kenyon" style="height:32px;"/><h1 class="page-title" id="page-title">Schedule Builder</h1></div>
<div class="page-actions"><button class="btn btn-secondary" onclick="resetAll()">â†º Reset</button><button class="btn btn-secondary" onclick="openExportModal()">â¬‡ Export</button><button class="btn btn-primary" onclick="calculateSchedule()">â–¶ Calculate Schedule</button></div>
</div></div>
<div class="main-content">
<div class="sidebar">
<div class="card animate-in"><div class="card-header"><span class="card-title">Schedule Settings</span></div><div class="card-body">
<div class="form-group"><label class="form-label">Job / Project Name</label><input type="text" class="form-input" id="job-name" placeholder="e.g. Sunrise Apartments â€” Building A" oninput="updateJobTitle();stateChanged();"/></div>
<div class="form-group"><label class="form-label">Scaffolding Start Date</label><input type="date" class="form-input form-input-mono" id="scaff-start-date" onchange="calculateSchedule();stateChanged();"/></div>
<div class="form-group"><label class="form-label">Lath Start Date</label><input type="date" class="form-input form-input-mono" id="lath-start-date" onchange="calculateSchedule();stateChanged();"/></div>
</div></div>
<div class="card animate-in" style="animation-delay:60ms"><div class="card-header"><span class="card-title">Production Rates</span><span style="font-size:11px;color:var(--gray-400)">yards/day</span></div><div class="card-body"><div id="rate-table"></div></div></div>
<div class="card animate-in" style="animation-delay:120ms"><div class="card-header"><span class="card-title">Summary</span></div><div class="card-body"><div class="stats-row">
<div class="stat-card"><div class="stat-value" id="stat-phases">0</div><div class="stat-label">Phases</div></div>
<div class="stat-card"><div class="stat-value" id="stat-yards">0</div><div class="stat-label">Total Yards</div></div>
<div class="stat-card"><div class="stat-value" id="stat-days">â€”</div><div class="stat-label">Calendar Days</div></div>
</div></div></div>
</div>
<div style="display:flex;flex-direction:column;gap:20px">
<div class="card animate-in" style="animation-delay:80ms"><div class="card-header"><span class="card-title">Phase Definitions</span><button class="btn btn-primary btn-sm" onclick="addPhase()">+ Add Phase</button></div>
<div style="overflow-x:auto"><table class="phase-table"><thead><tr><th style="width:40px"></th><th style="width:36px">#</th><th>Phase Name</th><th style="width:130px;text-align:right">Total Yards</th><th style="width:60px"></th></tr></thead><tbody id="phases-body"></tbody></table></div></div>
<div class="card animate-in" style="animation-delay:160ms" id="output-card"><div class="card-header"><span class="card-title">Calculated Schedule</span>
<div class="view-tabs"><button class="view-tab active" onclick="switchView('table',this)">Table</button><button class="view-tab" onclick="switchView('gantt',this)">Gantt</button><button class="view-tab" onclick="switchView('calendar',this)">Calendar</button></div></div>
<div class="tab-content active" id="view-table"><div style="overflow-x:auto"><table class="schedule-table"><thead><tr><th>Phase</th><th>Task</th><th style="text-align:right">Quantity</th><th style="text-align:right">Rate</th><th style="text-align:right">Duration</th><th>Start</th><th>End</th></tr></thead><tbody id="output-body"></tbody></table></div></div>
<div class="tab-content" id="view-gantt"><div class="gantt-container" id="gantt-container"><div class="empty-state"><div class="empty-state-icon">ðŸ“Š</div><div class="empty-state-text">Set start dates to view Gantt chart</div><div class="empty-state-sub">Enter scaffolding and lath start dates in Schedule Settings</div></div></div></div>
<div class="tab-content" id="view-calendar"><div style="overflow-x:auto"><table class="schedule-table"><thead><tr><th>Phase</th><th>Task</th><th>Start Date</th><th>End Date</th><th style="text-align:right">Work Days</th></tr></thead><tbody id="calendar-body"></tbody></table></div></div>
<div style="padding:12px 20px;border-top:1px solid var(--gray-100);font-size:12px;color:var(--gray-500);line-height:1.5">Durations rounded up to nearest whole day. Scaffolding before lath; finish after brown. Cure periods: <strong>2 cal days</strong> (scratchâ†’brown), <strong>7 cal days</strong> (brownâ†’finish). Cure runs through weekends; work tasks skip weekends.</div>
</div></div></div>
</div>
<div id="page-sov" style="display:none">
<div class="page-header"><div class="page-header-inner">
<div class="page-title-group"><img src="data:image/png;base64,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" alt="Kenyon" style="height:32px;"/><h1 class="page-title">Schedule of Values</h1><span class="badge" style="background:var(--blue-100);color:#1e40af">SOV</span></div>
<div class="page-actions"><button class="btn btn-secondary" onclick="resetSOV()">â†º Reset</button><button class="btn btn-secondary" onclick="openExportModal()">â¬‡ Export</button></div>
</div></div>
<div class="main-content">
<div class="sidebar">
<div class="card animate-in"><div class="card-header"><span class="card-title">Contract Info</span></div><div class="card-body">
<div class="form-group"><label class="form-label">Job / Project Name</label><input type="text" class="form-input" id="sov-job-name" placeholder="e.g. Sunrise Apartments â€” Building A" oninput="stateChanged()"/></div>
<div class="form-group"><label class="form-label">Total Contract Amount</label><div style="position:relative"><span style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--gray-500);font-weight:600">$</span><input type="text" class="form-input form-input-mono" id="sov-contract" placeholder="0.00" style="padding-left:24px" oninput="formatCurrencyInput(this);calcSOV();stateChanged();"/></div></div>
</div></div>
<div class="card animate-in" style="animation-delay:60ms"><div class="card-header"><span class="card-title">Misc Items</span><button class="btn btn-primary btn-sm" onclick="addMiscItem()">+ Add</button></div><div class="card-body">
<div style="font-size:11px;color:var(--gray-500);margin-bottom:10px">Subtracted from contract before distributing to elevations</div>
<div id="sov-misc-items"></div>
<div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding-top:10px;border-top:1px solid var(--gray-100)"><span style="font-size:12px;font-weight:600;color:var(--gray-600)">Total Misc</span><span class="mono" style="font-weight:700" id="sov-misc-total">$0.00</span></div>
<div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px"><span style="font-size:12px;font-weight:700;color:var(--accent)">Distributable Amount</span><span class="mono" style="font-weight:700;color:var(--accent)" id="sov-distributable">$0.00</span></div>
</div></div>
<div class="card animate-in" style="animation-delay:120ms"><div class="card-header"><span class="card-title">Task Split %</span><span style="font-size:11px" id="sov-split-total-label">Total: 100%</span></div><div class="card-body">
<div id="sov-split-rates"></div>
<div style="border-top:1px solid var(--gray-100);margin-top:8px;padding-top:8px">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px"><span style="font-size:11px;font-weight:600;color:var(--gray-500);text-transform:uppercase;letter-spacing:.4px">Misc Items</span><button class="btn btn-primary btn-sm" onclick="addCustomSplit()">+ Add</button></div>
<div style="font-size:11px;color:var(--gray-400);margin-bottom:6px">Check box to include in breakdown</div>
<div id="sov-custom-splits"></div>
</div></div></div>
</div>
<div style="display:flex;flex-direction:column;gap:20px">
<div class="card animate-in" style="animation-delay:80ms"><div class="card-header"><span class="card-title">Elevations / Phases</span><button class="btn btn-primary btn-sm" onclick="addSovElevation()">+ Add Elevation</button></div>
<div style="overflow-x:auto"><table class="phase-table"><thead><tr><th style="width:36px">#</th><th>Name</th><th style="width:130px;text-align:right">Lineal Feet</th><th style="width:100px;text-align:right">% of Total</th><th style="width:140px;text-align:right">Value</th><th style="width:50px"></th></tr></thead>
<tbody id="sov-elevations-body"></tbody>
<tfoot><tr style="background:var(--gray-50);font-weight:700"><td></td><td style="font-size:12px;text-transform:uppercase;letter-spacing:.3px;color:var(--gray-700);padding:10px 12px">Totals</td><td class="mono text-right" style="padding:10px 12px" id="sov-total-lf">0</td><td class="mono text-right" style="padding:10px 12px" id="sov-total-pct">0.0%</td><td class="mono text-right" style="padding:10px 12px" id="sov-total-value">$0.00</td><td></td></tr></tfoot></table></div></div>
<div class="card animate-in" style="animation-delay:160ms"><div class="card-header"><span class="card-title">SOV Breakdown</span></div>
<div style="overflow-x:auto" id="sov-breakdown-wrap"><table class="schedule-table" id="sov-breakdown-table"><thead id="sov-breakdown-head"></thead><tbody id="sov-breakdown-body"></tbody></table></div>
<div style="padding:12px 20px;border-top:1px solid var(--gray-100)"><div style="display:flex;justify-content:space-between;align-items:center"><span style="font-size:13px;font-weight:700;color:var(--gray-800)">Contract Total</span><span class="mono" style="font-size:15px;font-weight:700;color:var(--navy-800)" id="sov-grand-total">$0.00</span></div><div id="sov-balance-check" style="font-size:11px;margin-top:4px"></div></div>
</div></div></div>
</div>

<div class="modal-overlay" id="export-modal" onclick="if(event.target===this)closeExportModal()"><div class="modal">
<div class="modal-header"><span class="modal-title">Export Schedule</span><button class="modal-close" onclick="closeExportModal()">âœ•</button></div>
<div class="modal-body">
<div class="export-section"><div class="export-section-title">File Format</div><div class="export-option-group">
<div class="export-option selected" onclick="selectFormat('xlsx',this)"><div class="export-option-icon">ðŸ“Š</div><div class="export-option-label">Excel</div><div class="export-option-sub">.xlsx</div></div>
<div class="export-option" onclick="selectFormat('pdf',this)"><div class="export-option-icon">ðŸ“„</div><div class="export-option-label">PDF</div><div class="export-option-sub">.pdf</div></div>
</div></div>
<div class="export-section"><div class="export-section-title">What to Export</div><div class="export-option-group">
<div class="export-option selected" onclick="selectSection('duration',this)"><div class="export-option-icon">â±</div><div class="export-option-label">Duration Table</div><div class="export-option-sub">Task breakdown</div></div>
<div class="export-option" onclick="selectSection('calendar',this)"><div class="export-option-icon">ðŸ“†</div><div class="export-option-label">Calendar Schedule</div><div class="export-option-sub">With dates</div></div>
<div class="export-option" onclick="selectSection('both',this)"><div class="export-option-icon">ðŸ“‹</div><div class="export-option-label">Both</div><div class="export-option-sub">Full export</div></div>
<div class="export-option" onclick="selectSection('sov',this)" id="sov-export-option"><div class="export-option-icon">ðŸ—°</div><div class="export-option-label">SOV</div><div class="export-option-sub">Schedule of Values</div></div>
</div></div>
<div class="export-section" id="column-toggles-section"><div class="export-section-title">Columns to Include</div><div class="column-toggle-list" id="column-toggles"></div></div>
<div class="export-section" id="gantt-option-section" style="display:none"><div class="export-section-title">Additional Options</div><div class="gantt-toggle"><input type="checkbox" id="export-gantt-toggle"/><label for="export-gantt-toggle">Include Gantt chart in PDF</label></div></div>
</div>
<div class="modal-footer"><button class="btn btn-secondary" onclick="closeExportModal()">Cancel</button><button class="btn btn-primary" onclick="executeExport()" id="export-execute-btn">â¬‡ Export Excel</button></div>
</div></div>
<div class="tooltip" id="tooltip"></div>
<script>
const DEFAULT_RATES=[{id:'scaffold',label:'Scaffolding',rate:500,included:true,color:'scaffold'},{id:'lath',label:'Lath',rate:180,included:true,color:'lath'},{id:'scratch',label:'Scratch',rate:1400,included:true,color:'scratch'},{id:'brown',label:'Brown',rate:700,included:true,color:'brown'},{id:'finish',label:'Finish',rate:500,included:true,color:'finish'}];
let rates=JSON.parse(JSON.stringify(DEFAULT_RATES)),phases=[{name:'Phase 1',totalYards:0}],calendarData=[],durationData=[],exportFormat='xlsx',exportSection='duration';
const DURATION_COLUMNS=[{key:'phase',label:'Phase'},{key:'task',label:'Task'},{key:'quantity',label:'Quantity (yards)'},{key:'rate',label:'Rate (yards/day)'},{key:'duration',label:'Duration (days)'},{key:'start',label:'Start Date'},{key:'end',label:'End Date'}];
const CALENDAR_COLUMNS=[{key:'phase',label:'Phase'},{key:'task',label:'Task'},{key:'start',label:'Start Date'},{key:'end',label:'End Date'},{key:'workDays',label:'Work Days'}];
let selectedColumns={};const DUR_DEFAULTS=['phase','task','duration'];function initCols(){DURATION_COLUMNS.forEach(c=>{selectedColumns['dur_'+c.key]=DUR_DEFAULTS.includes(c.key)});CALENDAR_COLUMNS.forEach(c=>{selectedColumns['cal_'+c.key]=true})}initCols();
window.onload=function(){loadFromStorage();renderRates();renderPhases();calculateSchedule();renderSovSplits();renderSovMisc();renderSovElevations();calcSOV();document.addEventListener('keydown',function(e){if((e.ctrlKey||e.metaKey)&&e.key==='z'&&!e.shiftKey){e.preventDefault();undo()}if((e.ctrlKey||e.metaKey)&&(e.key==='y'||(e.key==='z'&&e.shiftKey))){e.preventDefault();redo()}});setTimeout(()=>{undoStack.push(getSnapshot());updateUndoButtons()},100)};
const STORAGE_KEY='kenyoncore_data';let saveTimeout=null;
function saveToStorage(){clearTimeout(saveTimeout);saveTimeout=setTimeout(()=>{try{const data={rates,phases,jobName:document.getElementById('job-name')?.value||'',scaffStart:document.getElementById('scaff-start-date')?.value||'',lathStart:document.getElementById('lath-start-date')?.value||'',sovContract:document.getElementById('sov-contract')?.value||'',sovContractRaw:document.getElementById('sov-contract')?.dataset?.raw||'',sovMiscItems,sovElevations,sovSplits,sovCustomSplits,sovCustomCounter,sovJobName:document.getElementById('sov-job-name')?.value||''};localStorage.setItem(STORAGE_KEY,JSON.stringify(data));showSaveIndicator()}catch(e){console.warn('Save failed:',e)}},500)}
function loadFromStorage(){try{const raw=localStorage.getItem(STORAGE_KEY);if(!raw)return;const data=JSON.parse(raw);if(data.rates)rates=data.rates;if(data.phases)phases=data.phases;if(data.jobName){const el=document.getElementById('job-name');if(el){el.value=data.jobName;updateJobTitle()}}if(data.scaffStart){const el=document.getElementById('scaff-start-date');if(el)el.value=data.scaffStart}if(data.lathStart){const el=document.getElementById('lath-start-date');if(el)el.value=data.lathStart}if(data.sovContract){const el=document.getElementById('sov-contract');if(el){el.value=data.sovContract;el.dataset.raw=data.sovContractRaw||''}}if(data.sovMiscItems)sovMiscItems=data.sovMiscItems;if(data.sovElevations)sovElevations=data.sovElevations;if(data.sovSplits)sovSplits=data.sovSplits;if(data.sovCustomSplits)sovCustomSplits=data.sovCustomSplits;if(data.sovCustomCounter)sovCustomCounter=data.sovCustomCounter;if(data.sovJobName){const el=document.getElementById('sov-job-name');if(el)el.value=data.sovJobName}}catch(e){console.warn('Load failed:',e)}}
function showSaveIndicator(){let ind=document.getElementById('save-indicator');if(!ind){ind=document.createElement('div');ind.id='save-indicator';ind.style.cssText='position:fixed;bottom:20px;right:20px;background:var(--navy-900);color:#fff;padding:8px 14px;border-radius:var(--radius-sm);font-size:12px;font-weight:600;opacity:0;transition:opacity 300ms;z-index:999;pointer-events:none';document.body.appendChild(ind)}ind.textContent='âœ” Saved';ind.style.opacity='1';setTimeout(()=>{ind.style.opacity='0'},1500)}
let undoStack=[],redoStack=[],snapshotTimeout=null;const MAX_UNDO=30;
function getSnapshot(){return JSON.stringify({rates,phases,jobName:document.getElementById('job-name')?.value||'',scaffStart:document.getElementById('scaff-start-date')?.value||'',lathStart:document.getElementById('lath-start-date')?.value||'',sovContract:document.getElementById('sov-contract')?.value||'',sovContractRaw:document.getElementById('sov-contract')?.dataset?.raw||'',sovMiscItems,sovElevations,sovSplits,sovCustomSplits,sovCustomCounter,sovJobName:document.getElementById('sov-job-name')?.value||''})}
function pushUndo(){clearTimeout(snapshotTimeout);snapshotTimeout=setTimeout(()=>{const snap=getSnapshot();if(undoStack.length===0||undoStack[undoStack.length-1]!==snap){undoStack.push(snap);if(undoStack.length>MAX_UNDO)undoStack.shift();redoStack=[];updateUndoButtons()}},600)}
function restoreSnapshot(snap){const data=JSON.parse(snap);rates=data.rates||rates;phases=data.phases||phases;const jn=document.getElementById('job-name');if(jn){jn.value=data.jobName||'';updateJobTitle()}const ss=document.getElementById('scaff-start-date');if(ss)ss.value=data.scaffStart||'';const ls=document.getElementById('lath-start-date');if(ls)ls.value=data.lathStart||'';const sc=document.getElementById('sov-contract');if(sc){sc.value=data.sovContract||'';sc.dataset.raw=data.sovContractRaw||''}sovMiscItems=data.sovMiscItems||[];sovElevations=data.sovElevations||[{name:'Elevation 1',lf:0}];sovSplits=data.sovSplits||sovSplits;sovCustomSplits=data.sovCustomSplits||[];sovCustomCounter=data.sovCustomCounter||0;const sjn=document.getElementById('sov-job-name');if(sjn)sjn.value=data.sovJobName||'';renderRates();renderPhases();calculateSchedule();renderSovSplits();renderSovMisc();renderSovElevations();calcSOV();saveToStorage()}
function undo(){if(undoStack.length<2)return;const current=undoStack.pop();redoStack.push(current);restoreSnapshot(undoStack[undoStack.length-1]);updateUndoButtons()}
function redo(){if(!redoStack.length)return;const snap=redoStack.pop();undoStack.push(snap);restoreSnapshot(snap);updateUndoButtons()}
function updateUndoButtons(){const ub=document.getElementById('undo-btn'),rb=document.getElementById('redo-btn');if(ub)ub.style.opacity=undoStack.length>1?'1':'.35';if(rb)rb.style.opacity=redoStack.length>0?'1':'.35'}
function stateChanged(){pushUndo();saveToStorage()}
function renderRates(){const c=document.getElementById('rate-table');c.innerHTML='';rates.forEach((r,i)=>{const row=document.createElement('div');row.className='rate-row';row.innerHTML=`<input type="checkbox" class="rate-check" ${r.included?'checked':''} onchange="rates[${i}].included=this.checked;calculateSchedule();stateChanged()"/><span class="task-dot task-dot-${r.color}"></span><span class="rate-label">${r.label}</span><input type="number" class="rate-input" value="${r.rate}" min="0" oninput="rates[${i}].rate=parseFloat(this.value)||0;calculateSchedule();stateChanged()"/><span class="rate-unit">yd/d</span>`;c.appendChild(row)})}
let dragSrcIdx=null;
function renderPhases(){const tbody=document.getElementById('phases-body');tbody.innerHTML='';phases.forEach((p,i)=>{const tr=document.createElement('tr');tr.dataset.idx=i;tr.innerHTML=`<td style="width:40px"><span class="phase-drag-handle" draggable="true">â ¿</span></td><td style="width:36px"><span class="phase-number">${i+1}</span></td><td><input class="phase-name-input" value="${esc(p.name)}" oninput="phases[${i}].name=this.value;calculateSchedule();stateChanged()"/></td><td style="text-align:right"><input class="phase-yards-input" type="number" min="0" value="${p.totalYards}" oninput="phases[${i}].totalYards=parseFloat(this.value)||0;calculateSchedule();stateChanged()"/></td><td style="text-align:center">${phases.length>1?`<button class="btn-icon btn-sm" onclick="removePhase(${i})">âœ•</button>`:''}</td>`;const handle=tr.querySelector('.phase-drag-handle');handle.addEventListener('dragstart',function(e){dragSrcIdx=+tr.dataset.idx;tr.classList.add('dragging');e.dataTransfer.effectAllowed='move';e.dataTransfer.setDragImage(tr,0,0)});handle.addEventListener('dragend',function(){tr.classList.remove('dragging');tbody.querySelectorAll('tr').forEach(r=>r.classList.remove('drag-over'))});tr.addEventListener('dragover',function(e){if(dragSrcIdx===null)return;e.preventDefault();e.dataTransfer.dropEffect='move';tbody.querySelectorAll('tr').forEach(r=>r.classList.remove('drag-over'));this.classList.add('drag-over')});tr.addEventListener('dragleave',function(){this.classList.remove('drag-over')});tr.addEventListener('drop',function(e){if(dragSrcIdx===null)return;e.preventDefault();this.classList.remove('drag-over');const to=+this.dataset.idx;if(dragSrcIdx!==to){const item=phases.splice(dragSrcIdx,1)[0];phases.splice(to,0,item);renderPhases();calculateSchedule();stateChanged()}dragSrcIdx=null});tbody.appendChild(tr)});updateSummary()}
function addPhase(){phases.push({name:`Phase ${phases.length+1}`,totalYards:0});renderPhases();stateChanged()}
function removePhase(i){phases.splice(i,1);renderPhases();stateChanged()}
function resetAll(){rates=JSON.parse(JSON.stringify(DEFAULT_RATES));phases=[{name:'Phase 1',totalYards:0}];document.getElementById('scaff-start-date').value='';document.getElementById('lath-start-date').value='';document.getElementById('job-name').value='';updateJobTitle();renderRates();renderPhases();calculateSchedule();stateChanged()}
function updateJobTitle(){const name=document.getElementById('job-name').value.trim();document.getElementById('page-title').textContent=name||'Schedule Builder'}
function getJobName(){return document.getElementById('job-name').value.trim()||'Schedule'}
function getSovJobName(){return document.getElementById('sov-job-name')?.value?.trim()||getJobName()}
function calculateSchedule(){const ob=document.getElementById('output-body');ob.innerHTML='';durationData=[];const rm={};rates.forEach(r=>{rm[r.id]=r});phases.forEach(phase=>{const qty=parseFloat(phase.totalYards)||0;if(qty<=0)return;const gr=document.createElement('tr');gr.className='phase-group';gr.innerHTML=`<td colspan="7">${esc(phase.name)} â€” ${qty.toLocaleString()} yards</td>`;ob.appendChild(gr);const tasks=[{id:'scaffold',label:'Scaffolding',cure:0},{id:'lath',label:'Lath',cure:0},{id:'scratch',label:'Scratch',cure:2,cureLabel:'Cure (after Scratch)'},{id:'brown',label:'Brown',cure:7,cureLabel:'Cure (after Brown)'},{id:'finish',label:'Finish',cure:0}];let phaseTotalDays=0;tasks.forEach(t=>{const r=rm[t.id];if(!r.included||r.rate<=0)return;const days=Math.ceil(qty/r.rate);phaseTotalDays+=days;durationData.push({phase:phase.name,task:t.label,quantity:qty,rate:r.rate,duration:days,start:'',end:''});const tr=document.createElement('tr');tr.innerHTML=`<td></td><td><span class="task-badge"><span class="task-dot task-dot-${r.color}"></span>${t.label}</span></td><td class="text-right mono">${qty.toLocaleString()}</td><td class="text-right mono">${r.rate.toLocaleString()}</td><td class="text-right mono">${days} day${days!==1?'s':''}</td><td class="text-muted">â€”</td><td class="text-muted">â€”</td>`;ob.appendChild(tr);if(t.cure>0){phaseTotalDays+=t.cure;durationData.push({phase:phase.name,task:t.cureLabel,quantity:null,rate:null,duration:t.cure,start:'',end:''});const cr=document.createElement('tr');cr.innerHTML=`<td></td><td><span class="task-badge"><span class="task-dot task-dot-cure"></span>${t.cureLabel}</span></td><td class="text-right mono text-muted">â€”</td><td class="text-right mono text-muted">â€”</td><td class="text-right mono">${t.cure} day${t.cure!==1?'s':''}</td><td class="text-muted">â€”</td><td class="text-muted">â€”</td>`;ob.appendChild(cr)}});if(phaseTotalDays>0){durationData.push({phase:phase.name,task:'TOTAL DURATION',quantity:null,rate:null,duration:phaseTotalDays,start:'',end:'',isTotal:true});const tot=document.createElement('tr');tot.className='phase-total';tot.innerHTML=`<td></td><td style="font-weight:700">Total Duration</td><td></td><td></td><td class="text-right mono" style="font-weight:700;font-size:13px">${phaseTotalDays} day${phaseTotalDays!==1?'s':''}</td><td></td><td></td>`;ob.appendChild(tot)}});updateSummary();buildCalendarSchedule()}
function updateSummary(){document.getElementById('stat-phases').textContent=phases.length;const ty=phases.reduce((s,p)=>s+(parseFloat(p.totalYards)||0),0);document.getElementById('stat-yards').textContent=ty.toLocaleString();}
function nextWorkday(d){const r=new Date(d.getFullYear(),d.getMonth(),d.getDate());while(r.getDay()===0||r.getDay()===6)r.setDate(r.getDate()+1);return r}
function addWorkDays(d,n){let r=new Date(d.getFullYear(),d.getMonth(),d.getDate()),c=0;while(c<n){r.setDate(r.getDate()+1);if(r.getDay()!==0&&r.getDay()!==6)c++}return r}
function addCalDays(d,n){return new Date(d.getFullYear(),d.getMonth(),d.getDate()+n)}
function fmtDate(d){if(!d)return'â€”';const m=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];return`${m[d.getMonth()]} ${d.getDate()}, ${d.getFullYear()}`}
function fmtDateShort(d){if(!d)return'';return`${d.getMonth()+1}/${d.getDate()}`}
function dateDiff(a,b){return Math.round((b-a)/(1000*60*60*24))}
function buildCalendarSchedule(){const cb=document.getElementById('calendar-body');cb.innerHTML='';calendarData=[];const si=document.getElementById('scaff-start-date').value,li=document.getElementById('lath-start-date').value;if(!si||!li){document.getElementById('stat-days').textContent='â€”';durationData.forEach(d=>{d.start='';d.end=''});buildGantt();return}const[sY,sM,sD]=si.split('-').map(Number),[lY,lM,lD]=li.split('-').map(Number);const gss=nextWorkday(new Date(sY,sM-1,sD)),gls=nextWorkday(new Date(lY,lM-1,lD));const rm={};rates.forEach(r=>{rm[r.id]=r});let sc=new Date(gss.getTime()),lc=new Date(gls.getTime()),gMin=null,gMax=null,di=0;function track(s,e){if(s&&(!gMin||s<gMin))gMin=new Date(s);if(e&&(!gMax||e>gMax))gMax=new Date(e)}function matchDur(tn,s,e){for(let i=di;i<durationData.length;i++){if(durationData[i].isTotal)continue;if(durationData[i].task===tn&&!durationData[i].start){durationData[i].start=fmtDate(s);durationData[i].end=fmtDate(e);di=i+1;break}}}function addCR(pn,tn,s,e,wd,tt){calendarData.push({phase:pn,task:tn,start:s,end:e,workDays:wd,taskType:tt});track(s,e);const ip=cb.children.length===0||cb.lastElementChild?.dataset.phase!==pn;if(ip){const g=document.createElement('tr');g.className='phase-group';g.dataset.phase=pn;g.innerHTML=`<td colspan="5">${esc(pn)}</td>`;cb.appendChild(g)}const tr=document.createElement('tr');tr.dataset.phase=pn;tr.innerHTML=`<td></td><td><span class="task-badge"><span class="task-dot task-dot-${tt}"></span>${tn}</span></td><td class="mono">${fmtDate(s)}</td><td class="mono">${fmtDate(e)}</td><td class="text-right mono">${wd}</td>`;cb.appendChild(tr)}phases.forEach(phase=>{const qty=parseFloat(phase.totalYards)||0;if(qty<=0)return;const rS=rm.scaffold,rL=rm.lath,rSc=rm.scratch,rB=rm.brown,rF=rm.finish;const dS=rS.rate>0?Math.ceil(qty/rS.rate):0,dL=rL.rate>0?Math.ceil(qty/rL.rate):0,dSc=rSc.rate>0?Math.ceil(qty/rSc.rate):0,dB=rB.rate>0?Math.ceil(qty/rB.rate):0,dF=rF.rate>0?Math.ceil(qty/rF.rate):0;let ss=null,se=null;if(dS>0){const c=new Date(Math.max(sc.getTime(),gss.getTime()));ss=nextWorkday(c);se=addWorkDays(ss,dS-1);sc=addWorkDays(ss,dS);if(rS.included){addCR(phase.name,'Scaffolding',ss,se,dS,'scaffold');matchDur('Scaffolding',ss,se)}}let ls=null,le=null;if(dL>0){const c=new Date(Math.max(lc.getTime(),gls.getTime()));ls=nextWorkday(c);le=addWorkDays(ls,dL-1);lc=addWorkDays(ls,dL);if(rL.included){addCR(phase.name,'Lath',ls,le,dL,'lath');matchDur('Lath',ls,le)}}let pe=le||ls||se||gls,stg=pe,scE=null,c1E=null;if(rSc.included&&dSc>0){const scS=nextWorkday(addCalDays(stg,1));scE=addWorkDays(scS,dSc-1);addCR(phase.name,'Scratch',scS,scE,dSc,'scratch');matchDur('Scratch',scS,scE);const c1S=addCalDays(scS,1);c1E=addCalDays(c1S,1);addCR(phase.name,'Cure (after Scratch)',c1S,c1E,2,'cure');matchDur('Cure (after Scratch)',c1S,c1E);stg=c1E}let bE=null,c2E=null;if(rB.included&&dB>0){const bS=nextWorkday(addCalDays(stg,1));bE=addWorkDays(bS,dB-1);addCR(phase.name,'Brown',bS,bE,dB,'brown');matchDur('Brown',bS,bE);const c2S=addCalDays(bS,1);c2E=addCalDays(c2S,6);addCR(phase.name,'Cure (after Brown)',c2S,c2E,7,'cure');matchDur('Cure (after Brown)',c2S,c2E);stg=c2E}if(rF.included&&dF>0){let fb;if(rB.included&&dB>0&&c2E)fb=c2E;else if(rSc.included&&dSc>0&&c1E)fb=c1E;else fb=pe||stg;const fS=nextWorkday(addCalDays(fb,1)),fE=addWorkDays(fS,dF-1);addCR(phase.name,'Finish',fS,fE,dF,'finish');matchDur('Finish',fS,fE)}});updateTableDates();if(gMin&&gMax)document.getElementById('stat-days').textContent=dateDiff(gMin,gMax)+1;buildGantt()}
function updateTableDates(){const rows=document.getElementById('output-body').querySelectorAll('tr:not(.phase-group):not(.phase-total)');let i=0;rows.forEach(tr=>{while(i<durationData.length&&durationData[i].isTotal)i++;const c=tr.querySelectorAll('td');if(c.length>=7&&i<durationData.length){c[5].innerHTML=`<span class="mono">${durationData[i].start||'â€”'}</span>`;c[6].innerHTML=`<span class="mono">${durationData[i].end||'â€”'}</span>`;i++}})}
function buildGantt(){const c=document.getElementById('gantt-container');if(!calendarData.length){c.innerHTML=`<div class="empty-state"><div class="empty-state-icon">ðŸ“Š</div><div class="empty-state-text">Set start dates and phase yards to view Gantt chart</div><div class="empty-state-sub">Enter scaffolding & lath start dates in Schedule Settings</div></div>`;return}let mn=null,mx=null;calendarData.forEach(d=>{if(d.start&&(!mn||d.start<mn))mn=new Date(d.start);if(d.end&&(!mx||d.end>mx))mx=new Date(d.end)});if(!mn||!mx)return;mn=addCalDays(mn,-2);mx=addCalDays(mx,3);const td=dateDiff(mn,mx)+1,dw=Math.max(18,Math.min(36,900/td)),tw=td*dw;let h=`<div class="gantt-header-row" style="min-width:${180+tw}px">`;for(let i=0;i<td;i++){const d=addCalDays(mn,i),sl=d.getDate()===1||(d.getDay()===1&&dw>=24);h+=`<div class="gantt-date-label" style="width:${dw}px;min-width:${dw}px">${sl?fmtDateShort(d):''}</div>`}h+='</div>';let cp='';calendarData.forEach(item=>{if(item.phase!==cp){cp=item.phase;h+=`<div class="gantt-phase-header" style="min-width:${180+tw}px">${esc(item.phase)}</div>`}const so=dateDiff(mn,item.start),eo=dateDiff(mn,item.end),bl=so*dw,bw=Math.max(dw*.5,(eo-so+1)*dw-2);h+=`<div class="gantt-row" style="min-width:${180+tw}px"><div class="gantt-label">${item.task}</div><div class="gantt-track" style="width:${tw}px;min-width:${tw}px"><div class="gantt-bar gantt-bar-${item.taskType}" style="left:${bl}px;width:${bw}px" onmouseenter="showTT(event,'${esc(item.task)}: ${fmtDate(item.start)} â†’ ${fmtDate(item.end)} (${item.workDays}d)')" onmouseleave="hideTT()">${item.workDays}d</div></div></div>`});c.innerHTML=h}
function showTT(e,t){const tip=document.getElementById('tooltip');tip.textContent=t;tip.style.display='block';tip.style.left=e.pageX+12+'px';tip.style.top=e.pageY-10+'px'}
function hideTT(){document.getElementById('tooltip').style.display='none'}
function switchView(v,b){document.querySelectorAll('.view-tab').forEach(t=>t.classList.remove('active'));b.classList.add('active');document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));document.getElementById('view-'+v).classList.add('active')}
function openExportModal(){document.getElementById('export-modal').classList.add('open');exportFormat='xlsx';exportSection=currentPage==='sov'?'sov':'duration';renderExportModal();const opts=document.querySelectorAll('#export-modal .export-section:nth-child(2) .export-option');opts.forEach(o=>o.classList.remove('selected'));opts.forEach(o=>{if((currentPage==='sov'&&o.textContent.includes('SOV'))||(currentPage!=='sov'&&o.textContent.includes('Duration')))o.classList.add('selected')})}
function closeExportModal(){document.getElementById('export-modal').classList.remove('open')}
function selectFormat(f,el){exportFormat=f;el.parentElement.querySelectorAll('.export-option').forEach(o=>o.classList.remove('selected'));el.classList.add('selected');renderExportModal()}
function selectSection(s,el){exportSection=s;el.parentElement.querySelectorAll('.export-option').forEach(o=>o.classList.remove('selected'));el.classList.add('selected');renderExportModal()}
function renderExportModal(){document.getElementById('export-execute-btn').textContent=exportFormat==='xlsx'?'â¬‡ Export Excel':'â¬‡ Export PDF';const isSov=exportSection==='sov';document.getElementById('gantt-option-section').style.display=(exportFormat==='pdf'&&!isSov)?'block':'none';document.getElementById('column-toggles-section').style.display=isSov?'none':'block';const ct=document.getElementById('column-toggles');ct.innerHTML='';if(isSov)return;let groups=[];if(exportSection==='duration'||exportSection==='both')groups.push({header:'Duration Table',cols:DURATION_COLUMNS,prefix:'dur_'});if(exportSection==='calendar'||exportSection==='both')groups.push({header:'Calendar Schedule',cols:CALENDAR_COLUMNS,prefix:'cal_'});groups.forEach(g=>{if(exportSection==='both'){const gl=document.createElement('div');gl.style.cssText='font-size:11px;font-weight:700;color:var(--gray-500);margin:10px 0 6px;text-transform:uppercase;letter-spacing:.4px';gl.textContent=g.header;ct.appendChild(gl)}g.cols.forEach(col=>{const k=g.prefix+col.key,d=document.createElement('div');d.className='column-toggle';d.innerHTML=`<input type="checkbox" id="col-${k}" ${selectedColumns[k]?'checked':''} onchange="selectedColumns['${k}']=this.checked"/><label for="col-${k}">${col.label}</label>${exportSection==='both'?`<span class="col-preview">${g.prefix==='dur_'?'Duration':'Calendar'}</span>`:''}`;ct.appendChild(d)})})}
function executeExport(){if(exportFormat==='xlsx')exportExcel();else exportPDF();closeExportModal()}
function exportExcel(){const wb=XLSX.utils.book_new(),jobName=getJobName();if(exportSection==='duration'||exportSection==='both'){const cols=DURATION_COLUMNS.filter(c=>selectedColumns['dur_'+c.key]),hdr=cols.map(c=>c.label),rows=durationData.map(d=>cols.map(c=>{switch(c.key){case'phase':return d.isTotal?(d.phase||''):(d.phase||'');case'task':return d.isTotal?'TOTAL DURATION':d.task;case'quantity':return d.quantity!==null?d.quantity:'';case'rate':return d.rate!==null?d.rate:'';case'duration':return d.duration;case'start':return d.start||'';case'end':return d.end||'';default:return''}}));const titleRow=[jobName];for(let i=1;i<hdr.length;i++)titleRow.push('');const dateRow=['Exported: '+new Date().toLocaleDateString()];for(let i=1;i<hdr.length;i++)dateRow.push('');const wsData=[titleRow,dateRow,[],hdr,...rows],ws=XLSX.utils.aoa_to_sheet(wsData);ws['!cols']=cols.map(c=>({wch:['phase','task'].includes(c.key)?24:['start','end'].includes(c.key)?18:16}));if(hdr.length>1)ws['!merges']=[{s:{r:0,c:0},e:{r:0,c:hdr.length-1}},{s:{r:1,c:0},e:{r:1,c:hdr.length-1}}];const hdrRow=3,dataStart=4,numCols=hdr.length,medB={style:'medium',color:{rgb:'000000'}},thinB={style:'thin',color:{rgb:'000000'}};const phaseGroups=[];let gStart=null,curPhase=null;durationData.forEach((d,i)=>{if(d.phase!==curPhase){if(gStart!==null)phaseGroups.push({start:gStart,end:i-1});gStart=i;curPhase=d.phase}});if(gStart!==null)phaseGroups.push({start:gStart,end:durationData.length-1});for(let r=hdrRow;r<wsData.length;r++){const di=r-dataStart;const isTotal=di>=0&&di<durationData.length&&durationData[di].isTotal;let isPhaseFirst=false,isPhaseLast=false;phaseGroups.forEach(g=>{if(di===g.start)isPhaseFirst=true;if(di===g.end)isPhaseLast=true});for(let c=0;c<numCols;c++){const ref=XLSX.utils.encode_cell({r,c});if(!ws[ref])ws[ref]={v:'',t:'s'};if(!ws[ref].s)ws[ref].s={};const s=ws[ref].s;const border={};if(r===hdrRow){border.top=medB;border.bottom=medB;s.font={bold:true};s.fill={fgColor:{rgb:'D9E1F2'}}}if(di>=0){if(isPhaseFirst)border.top=medB;if(isPhaseLast)border.bottom=medB;if(c===0)border.left=medB;if(c===numCols-1)border.right=medB;if(!isPhaseFirst&&!border.top)border.top=thinB;if(c>0&&!border.left)border.left=thinB}if(isTotal){s.font={bold:true}}s.border=border}}XLSX.utils.book_append_sheet(wb,ws,'Duration Schedule')}if(exportSection==='calendar'||exportSection==='both'){const cols=CALENDAR_COLUMNS.filter(c=>selectedColumns['cal_'+c.key]),hdr=cols.map(c=>c.label),rows=calendarData.map(d=>cols.map(c=>{switch(c.key){case'phase':return d.phase;case'task':return d.task;case'start':return fmtDate(d.start);case'end':return fmtDate(d.end);case'workDays':return d.workDays;default:return''}}));const titleRow=[jobName];for(let i=1;i<hdr.length;i++)titleRow.push('');const dateRow=['Exported: '+new Date().toLocaleDateString()];for(let i=1;i<hdr.length;i++)dateRow.push('');const wsData=[titleRow,dateRow,[],hdr,...rows],ws=XLSX.utils.aoa_to_sheet(wsData);ws['!cols']=cols.map(c=>({wch:['phase','task'].includes(c.key)?24:['start','end'].includes(c.key)?18:12}));if(hdr.length>1)ws['!merges']=[{s:{r:0,c:0},e:{r:0,c:hdr.length-1}},{s:{r:1,c:0},e:{r:1,c:hdr.length-1}}];XLSX.utils.book_append_sheet(wb,ws,'Calendar Schedule')}if(exportSection==='sov'||exportSection==='both'){buildSovExcelSheet(wb,jobName)}XLSX.writeFile(wb,jobName.replace(/[^a-zA-Z0-9 ]/g,'').replace(/ +/g,'_')+'_schedule.xlsx')}
function buildSovExcelSheet(wb,jobName){const contract=getContractAmount(),miscTotal=sovMiscItems.reduce((s,m)=>s+m.value,0),distributable=contract-miscTotal,totalLF=sovElevations.reduce((s,e)=>s+(parseFloat(e.lf)||0),0),activeSplits=getActiveSplits(),elevs=[];sovElevations.forEach(e=>{const lf=parseFloat(e.lf)||0,pct=totalLF>0?(lf/totalLF):0,ev=distributable*pct;if(ev>0)elevs.push({name:e.name,value:ev})});const hdr=[];elevs.forEach(e=>{hdr.push('Task');hdr.push(e.name)});const allCells=[];activeSplits.forEach(sp=>{elevs.forEach(el=>{allCells.push(el.value*(sp.pct/100))})});const target=Math.round(distributable),fl=allCells.map(v=>Math.floor(v)),rems=allCells.map((v,i)=>({i,rem:v-fl[i]})).sort((a,b)=>b.rem-a.rem);let diff=target-fl.reduce((s,v)=>s+v,0);for(let j=0;j<diff&&j<rems.length;j++)fl[rems[j].i]++;const rows=[];let ci=0;activeSplits.forEach(sp=>{const r=[];elevs.forEach((el,ei)=>{const v=fl[ci];r.push(sp.label);r.push(v);ci++});rows.push(r)});const totalRow=[];elevs.forEach((el,ei)=>{let elTotal=0;activeSplits.forEach((sp,si)=>{elTotal+=fl[si*elevs.length+ei]});totalRow.push('TOTAL');totalRow.push(elTotal)});rows.push(totalRow);const titleRow=[jobName+' â€” Schedule of Values'];for(let i=1;i<hdr.length;i++)titleRow.push('');const contractRow=['Contract: '+fmtWhole(contract)+'  |  Misc: '+fmtWhole(miscTotal)+'  |  Distributable: '+fmtWhole(distributable)];for(let i=1;i<hdr.length;i++)contractRow.push('');const wsData=[titleRow,contractRow,[],hdr,...rows],ws=XLSX.utils.aoa_to_sheet(wsData);const colWidths=[];elevs.forEach(()=>{colWidths.push({wch:16});colWidths.push({wch:14})});ws['!cols']=colWidths;if(hdr.length>1)ws['!merges']=[{s:{r:0,c:0},e:{r:0,c:hdr.length-1}},{s:{r:1,c:0},e:{r:1,c:hdr.length-1}}];const hdrRowIdx=3,dataStartRow=4,dataEndRow=wsData.length-1,numCols=hdr.length;const thinBorder={style:'thin',color:{rgb:'000000'}};const medBorder={style:'medium',color:{rgb:'000000'}};for(let r=hdrRowIdx;r<=dataEndRow;r++){for(let c=0;c<numCols;c++){const ref=XLSX.utils.encode_cell({r,c});if(!ws[ref])ws[ref]={v:'',t:'s'};if(!ws[ref].s)ws[ref].s={};const s=ws[ref].s;const border={};if(r===hdrRowIdx)border.top=medBorder;if(r===dataEndRow)border.bottom=medBorder;if(c===0)border.left=medBorder;if(c===numCols-1)border.right=medBorder;if(r>hdrRowIdx)border.top=thinBorder;if(c>0)border.left=thinBorder;if(r===hdrRowIdx){s.font={bold:true};s.fill={fgColor:{rgb:'D9E1F2'}}}if(r===dataEndRow){s.font={bold:true}}s.border=border;if(c%2===1&&r>=dataStartRow&&ws[ref]&&typeof ws[ref].v==='number'){ws[ref].z='$#,##0'}}}XLSX.utils.book_append_sheet(wb,ws,'Schedule of Values')}
async function exportPDF(){const{jsPDF}=window.jspdf,doc=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'}),pw=doc.internal.pageSize.getWidth(),or=[27,58,107],nv=[27,42,74],gr=[85,91,110],jobName=getJobName();doc.setFillColor(...nv);doc.rect(0,0,pw,14,'F');doc.setFont('helvetica','bold');doc.setFontSize(11);doc.setTextColor(255,255,255);doc.text(jobName,10,9.5);doc.setFontSize(8);doc.setTextColor(180,189,208);doc.text('Exported: '+new Date().toLocaleDateString(),pw-10,9.5,{align:'right'});let y=22;if(exportSection==='duration'||exportSection==='both'){doc.setFont('helvetica','bold');doc.setFontSize(13);doc.setTextColor(...nv);doc.text('Duration Schedule',10,y);y+=4;const cols=DURATION_COLUMNS.filter(c=>selectedColumns['dur_'+c.key]),hdr=cols.map(c=>c.label),rows=durationData.map(d=>cols.map(c=>{switch(c.key){case'phase':return d.phase;case'task':return d.task;case'quantity':return d.quantity!==null?d.quantity.toLocaleString():'â€”';case'rate':return d.rate!==null?d.rate.toLocaleString():'â€”';case'duration':return d.duration+' days';case'start':return d.start||'â€”';case'end':return d.end||'â€”';default:return''}})),cs={};cols.forEach((c,i)=>{if(['quantity','rate','duration','workDays'].includes(c.key))cs[i]={halign:'right'}});doc.autoTable({startY:y,head:[hdr],body:rows,theme:'grid',styles:{font:'helvetica',fontSize:8,cellPadding:3},headStyles:{fillColor:or,textColor:[255,255,255],fontStyle:'bold',fontSize:8},alternateRowStyles:{fillColor:[245,246,250]},columnStyles:cs,margin:{left:10,right:10}});y=doc.lastAutoTable.finalY+10}if(exportSection==='calendar'||exportSection==='both'){if(y>160){doc.addPage();y=15}doc.setFont('helvetica','bold');doc.setFontSize(13);doc.setTextColor(...nv);doc.text('Calendar Schedule',10,y);y+=4;const cols=CALENDAR_COLUMNS.filter(c=>selectedColumns['cal_'+c.key]),hdr=cols.map(c=>c.label),rows=calendarData.map(d=>cols.map(c=>{switch(c.key){case'phase':return d.phase;case'task':return d.task;case'start':return fmtDate(d.start);case'end':return fmtDate(d.end);case'workDays':return d.workDays.toString();default:return''}})),cs={};cols.forEach((c,i)=>{if(c.key==='workDays')cs[i]={halign:'right'}});doc.autoTable({startY:y,head:[hdr],body:rows,theme:'grid',styles:{font:'helvetica',fontSize:8,cellPadding:3},headStyles:{fillColor:or,textColor:[255,255,255],fontStyle:'bold',fontSize:8},alternateRowStyles:{fillColor:[245,246,250]},columnStyles:cs,margin:{left:10,right:10}});y=doc.lastAutoTable.finalY+10}if(exportSection==='sov'){const sovName=getSovJobName();const contract=getContractAmount(),miscTotal=sovMiscItems.reduce((s,m)=>s+m.value,0),distributable=contract-miscTotal,totalLF=sovElevations.reduce((s,e)=>s+(parseFloat(e.lf)||0),0),activeSplits=getActiveSplits();doc.setFont('helvetica','bold');doc.setFontSize(13);doc.setTextColor(...nv);doc.text(sovName+' â€” Schedule of Values',10,y);y+=2;doc.setFont('helvetica','normal');doc.setFontSize(9);doc.setTextColor(...gr);doc.text(`Contract: ${fmtWhole(contract)}    Misc Items: ${fmtWhole(miscTotal)}    Distributable: ${fmtWhole(distributable)}`,10,y+4);y+=10;const elevs=[];sovElevations.forEach(e=>{const lf=parseFloat(e.lf)||0,pct=totalLF>0?(lf/totalLF):0,ev=distributable*pct;if(ev>0)elevs.push({name:e.name,value:ev})});const hdr=[];elevs.forEach(e=>{hdr.push('Task');hdr.push(e.name)});const allCells=[];activeSplits.forEach(sp=>{elevs.forEach(el=>{allCells.push(el.value*(sp.pct/100))})});const target=Math.round(distributable),fl=allCells.map(v=>Math.floor(v)),rems=allCells.map((v,i)=>({i,rem:v-fl[i]})).sort((a,b)=>b.rem-a.rem);let diff=target-fl.reduce((s,v)=>s+v,0);for(let j=0;j<diff&&j<rems.length;j++)fl[rems[j].i]++;const rows=[];let ci=0;activeSplits.forEach(sp=>{const r=[];elevs.forEach((el,ei)=>{const v=fl[ci];r.push(sp.label);r.push(fmtWhole(v));ci++});rows.push(r)});const totalRow=[];elevs.forEach((el,ei)=>{let elTotal=0;activeSplits.forEach((sp,si)=>{elTotal+=fl[si*elevs.length+ei]});totalRow.push('TOTAL');totalRow.push(fmtWhole(elTotal))});rows.push(totalRow);const cs={};for(let i=0;i<hdr.length;i++){if(i%2===1)cs[i]={halign:'right'}}doc.autoTable({startY:y,head:[hdr],body:rows,theme:'grid',styles:{font:'helvetica',fontSize:8,cellPadding:3,lineWidth:0.1},headStyles:{fillColor:or,textColor:[255,255,255],fontStyle:'bold',fontSize:8},alternateRowStyles:{fillColor:[245,246,250]},columnStyles:cs,margin:{left:10,right:10},tableLineColor:[0,0,0],tableLineWidth:0.5});y=doc.lastAutoTable.finalY+10}if(document.getElementById('export-gantt-toggle')?.checked&&calendarData.length>0){const gc=document.getElementById('gantt-container'),wh=!document.getElementById('view-gantt').classList.contains('active');if(wh)document.getElementById('view-gantt').style.cssText='display:block;position:absolute;left:-9999px';try{const canvas=await html2canvas(gc,{scale:2,backgroundColor:'#ffffff',logging:false});doc.addPage();doc.setFillColor(...nv);doc.rect(0,0,pw,14,'F');doc.setFont('helvetica','bold');doc.setFontSize(11);doc.setTextColor(255,255,255);doc.text(jobName+' â€” Gantt Chart',10,9.5);const img=canvas.toDataURL('image/png'),iw=pw-20,ih=(canvas.height/canvas.width)*iw,mh=doc.internal.pageSize.getHeight()-30;doc.addImage(img,'PNG',10,20,iw,Math.min(ih,mh))}catch(e){console.error('Gantt export error:',e)}if(wh)document.getElementById('view-gantt').style.cssText=''}const pc=doc.internal.getNumberOfPages();for(let i=1;i<=pc;i++){doc.setPage(i);doc.setFont('helvetica','normal');doc.setFontSize(7);doc.setTextColor(...gr);const ph=doc.internal.pageSize.getHeight();doc.text(jobName+' â€” Confidential',10,ph-5);doc.text(`Page ${i} of ${pc}`,pw-10,ph-5,{align:'right'})}doc.save(jobName.replace(/[^a-zA-Z0-9 ]/g,'').replace(/ +/g,'_')+'_schedule.pdf')}
function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}
let currentPage='schedule';
function switchPage(page){currentPage=page;document.getElementById('page-schedule').style.display=page==='schedule'?'':'none';document.getElementById('page-sov').style.display=page==='sov'?'':'none';document.querySelectorAll('.topnav-tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.topnav-tab').forEach(t=>{const txt=t.textContent.trim().toLowerCase();if(txt===page||(page==='sov'&&t.textContent.trim()==='SOV'))t.classList.add('active')});if(page==='sov'){renderSovSplits();renderSovElevations();renderSovMisc();calcSOV()}}
let sovMiscItems=[],sovElevations=[{name:'Elevation 1',lf:0}],sovSplits=[{id:'scaffold',label:'Scaffolding',pct:20,color:'scaffold',core:true,included:true},{id:'lath',label:'Lath',pct:30,color:'lath',core:true,included:true},{id:'scratch',label:'Scratch',pct:15,color:'scratch',core:true,included:true},{id:'brown',label:'Brown',pct:20,color:'brown',core:true,included:true},{id:'finish',label:'Finish',pct:15,color:'finish',core:true,included:true}],sovCustomSplits=[],sovCustomCounter=0,sovData=[];
function parseCurrency(s){return parseFloat(String(s).replace(/[^0-9.\-]/g,''))||0}
function fmtMoney(n){return'$'+n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}
function fmtWhole(n){return'$'+Math.round(n).toLocaleString('en-US')}
function formatCurrencyInput(el){el.dataset.raw=el.value.replace(/[^0-9.]/g,'')}
function getContractAmount(){return parseCurrency(document.getElementById('sov-contract')?.dataset?.raw||document.getElementById('sov-contract')?.value||'0')}
function addMiscItem(){sovMiscItems.push({name:'',value:0});renderSovMisc();calcSOV();stateChanged()}
function removeMiscItem(i){sovMiscItems.splice(i,1);renderSovMisc();calcSOV();stateChanged()}
function renderSovMisc(){const c=document.getElementById('sov-misc-items');if(!c)return;c.innerHTML='';sovMiscItems.forEach((m,i)=>{const d=document.createElement('div');d.className='misc-item';d.innerHTML=`<input type="text" value="${esc(m.name)}" placeholder="Item name" oninput="sovMiscItems[${i}].name=this.value;stateChanged()"/><div class="misc-dollar" style="position:relative"><span>$</span><input type="text" class="misc-val" value="${m.value||''}" placeholder="0.00" oninput="sovMiscItems[${i}].value=parseCurrency(this.value);calcSOV();stateChanged()"/></div><button class="misc-remove" onclick="removeMiscItem(${i})">âœ•</button>`;c.appendChild(d)})}
function renderSovSplits(){const c=document.getElementById('sov-split-rates');if(!c)return;c.innerHTML='';sovSplits.forEach((s,i)=>{const row=document.createElement('div');row.className='rate-row';row.innerHTML=`<input type="checkbox" class="rate-check" ${s.included?'checked':''} onchange="sovSplits[${i}].included=this.checked;updateSplitTotal();calcSOV();stateChanged()"/><span class="task-dot task-dot-${s.color}"></span><span class="rate-label">${s.label}</span><input type="number" class="rate-input" value="${s.pct}" min="0" max="100" step="0.1" style="width:70px" oninput="sovSplits[${i}].pct=parseFloat(this.value)||0;updateSplitTotal();calcSOV();stateChanged()"/><span class="rate-unit">%</span>`;c.appendChild(row)});renderCustomSplits();updateSplitTotal()}
function addCustomSplit(){sovCustomSplits.push({id:'custom_'+(sovCustomCounter++),label:'',pct:0,included:false});renderCustomSplits();stateChanged()}
function removeCustomSplit(i){sovCustomSplits.splice(i,1);renderCustomSplits();calcSOV();stateChanged()}
function renderCustomSplits(){const c=document.getElementById('sov-custom-splits');if(!c)return;c.innerHTML='';sovCustomSplits.forEach((s,i)=>{const row=document.createElement('div');row.style.cssText='display:flex;align-items:center;gap:6px;margin-bottom:6px';row.innerHTML=`<input type="checkbox" class="rate-check" ${s.included?'checked':''} onchange="sovCustomSplits[${i}].included=this.checked;updateSplitTotal();calcSOV();stateChanged()"/><input type="text" value="${esc(s.label)}" placeholder="Item name" style="flex:1;padding:5px 8px;border:1px solid var(--gray-200);border-radius:var(--radius-sm);font-family:inherit;font-size:12px" oninput="sovCustomSplits[${i}].label=this.value;calcSOV();stateChanged()"/><input type="number" class="rate-input" value="${s.pct}" min="0" max="100" step="0.1" style="width:60px;font-size:12px;padding:5px 6px" oninput="sovCustomSplits[${i}].pct=parseFloat(this.value)||0;updateSplitTotal();calcSOV();stateChanged()"/><span class="rate-unit">%</span><button class="misc-remove" onclick="removeCustomSplit(${i})">âœ•</button>`;c.appendChild(row)})}
function getActiveSplits(){const a=[];sovSplits.forEach(s=>{if(s.included&&s.pct>0)a.push(s)});sovCustomSplits.forEach(s=>{if(s.included&&s.pct>0)a.push(s)});return a}
function updateSplitTotal(){const included=[...sovSplits.filter(s=>s.included),...sovCustomSplits.filter(s=>s.included)],total=included.reduce((s,r)=>s+r.pct,0),label=document.getElementById('sov-split-total-label');if(label){label.textContent='Total: '+total.toFixed(1)+'%';label.style.color=Math.abs(total-100)<.01?'var(--green-600)':'var(--red-600)'}}
function addSovElevation(){sovElevations.push({name:`Elevation ${sovElevations.length+1}`,lf:0});renderSovElevations();calcSOV();stateChanged()}
function removeSovElevation(i){sovElevations.splice(i,1);renderSovElevations();calcSOV();stateChanged()}
function renderSovElevations(){const tb=document.getElementById('sov-elevations-body');if(!tb)return;tb.innerHTML='';const totalLF=sovElevations.reduce((s,e)=>s+(parseFloat(e.lf)||0),0),contract=getContractAmount(),miscTotal=sovMiscItems.reduce((s,m)=>s+m.value,0),distributable=contract-miscTotal;sovElevations.forEach((e,i)=>{const lf=parseFloat(e.lf)||0,pct=totalLF>0?(lf/totalLF)*100:0,val=distributable*(pct/100),tr=document.createElement('tr');tr.innerHTML=`<td style="width:36px"><span class="phase-number">${i+1}</span></td><td><input class="phase-name-input" value="${esc(e.name)}" oninput="sovElevations[${i}].name=this.value;calcSOV();stateChanged()"/></td><td style="text-align:right"><input class="phase-yards-input" type="number" min="0" value="${e.lf}" oninput="sovElevations[${i}].lf=parseFloat(this.value)||0;updateSovElevationCalcs();calcSOV();stateChanged()"/></td><td class="text-right"><span class="sov-pct" id="sov-pct-${i}">${pct.toFixed(1)}%</span></td><td class="text-right"><span class="sov-elev-value" id="sov-val-${i}">${fmtMoney(val)}</span></td><td style="text-align:center">${sovElevations.length>1?`<button class="btn-icon btn-sm" onclick="removeSovElevation(${i})">âœ•</button>`:''}</td>`;tb.appendChild(tr)});document.getElementById('sov-total-lf').textContent=totalLF.toLocaleString();document.getElementById('sov-total-pct').textContent=totalLF>0?'100.0%':'0.0%';document.getElementById('sov-total-value').textContent=fmtMoney(totalLF>0?distributable:0)}
function updateSovElevationCalcs(){const totalLF=sovElevations.reduce((s,e)=>s+(parseFloat(e.lf)||0),0),contract=getContractAmount(),miscTotal=sovMiscItems.reduce((s,m)=>s+m.value,0),distributable=contract-miscTotal;sovElevations.forEach((e,i)=>{const lf=parseFloat(e.lf)||0,pct=totalLF>0?(lf/totalLF)*100:0,val=Math.round(distributable*(pct/100));const pctEl=document.getElementById('sov-pct-'+i),valEl=document.getElementById('sov-val-'+i);if(pctEl)pctEl.textContent=pct.toFixed(1)+'%';if(valEl)valEl.textContent=fmtWhole(val)});document.getElementById('sov-total-lf').textContent=totalLF.toLocaleString();document.getElementById('sov-total-pct').textContent=totalLF>0?'100.0%':'0.0%';document.getElementById('sov-total-value').textContent=fmtWhole(totalLF>0?distributable:0)}
function calcSOV(){const contract=getContractAmount(),miscTotal=sovMiscItems.reduce((s,m)=>s+m.value,0),distributable=Math.max(0,contract-miscTotal),totalLF=sovElevations.reduce((s,e)=>s+(parseFloat(e.lf)||0),0);document.getElementById('sov-misc-total').textContent=fmtWhole(miscTotal);document.getElementById('sov-distributable').textContent=fmtWhole(distributable);updateSovElevationCalcs();const head=document.getElementById('sov-breakdown-head'),body=document.getElementById('sov-breakdown-body');if(!head||!body)return;head.innerHTML='';body.innerHTML='';sovData=[];const activeSplits=getActiveSplits(),elevs=[];sovElevations.forEach(e=>{const lf=parseFloat(e.lf)||0,pct=totalLF>0?(lf/totalLF):0,ev=distributable*pct;if(ev>0)elevs.push({name:e.name,pct,value:ev})});if(!elevs.length||!activeSplits.length)return;const allCells=[];activeSplits.forEach(sp=>{elevs.forEach(el=>{allCells.push({splitId:sp.id||sp.label,elevName:el.name,raw:el.value*(sp.pct/100)})})});const target=Math.round(distributable),floored=allCells.map(c=>Math.floor(c.raw)),rems=allCells.map((c,i)=>({i,rem:c.raw-floored[i]})).sort((a,b)=>b.rem-a.rem);let diff=target-floored.reduce((s,v)=>s+v,0);for(let j=0;j<diff&&j<rems.length;j++)floored[rems[j].i]++;const grid=[];let ci=0;activeSplits.forEach((sp,si)=>{grid[si]=[];elevs.forEach((el,ei)=>{grid[si][ei]=floored[ci];ci++})});const htr=document.createElement('tr');htr.innerHTML=`<th>Task</th>${elevs.map(el=>`<th style="text-align:right">${esc(el.name)}</th>`).join('')}<th style="text-align:right">Total</th>`;head.appendChild(htr);const elevTotals=elevs.map(()=>0);let grandTotal=0;activeSplits.forEach((sp,si)=>{let rowTotal=0;const cells=elevs.map((el,ei)=>{const v=grid[si][ei];elevTotals[ei]+=v;rowTotal+=v;return v});grandTotal+=rowTotal;const dotClass=sp.color?`task-dot-${sp.color}`:'',dot=sp.color?`<span class="task-dot ${dotClass}"></span>`:`<span class="task-dot" style="background:var(--gray-400)"></span>`;const tr=document.createElement('tr');tr.innerHTML=`<td><span class="task-badge">${dot}${esc(sp.label)}</span></td>${cells.map(v=>`<td class="text-right mono">${fmtWhole(v)}</td>`).join('')}<td class="text-right mono" style="font-weight:600">${fmtWhole(rowTotal)}</td>`;body.appendChild(tr);sovData.push({task:sp.label,values:cells,total:rowTotal})});sovMiscItems.forEach(m=>{if(m.value<=0&&!m.name)return;const mv=Math.round(m.value);grandTotal+=mv;const tr=document.createElement('tr');tr.style.cssText='background:var(--gray-50);font-style:italic;color:var(--gray-600)';tr.innerHTML=`<td>${esc(m.name||'Misc Item')}</td>${elevs.map(()=>`<td class="text-right mono">â€”</td>`).join('')}<td class="text-right mono" style="font-weight:600">${fmtWhole(mv)}</td>`;body.appendChild(tr);sovData.push({task:m.name||'Misc Item',values:elevs.map(()=>0),total:mv,isMisc:true})});const totTr=document.createElement('tr');totTr.className='phase-total';totTr.innerHTML=`<td style="font-weight:700">Total</td>${elevTotals.map(v=>`<td class="text-right mono" style="font-weight:700">${fmtWhole(v)}</td>`).join('')}<td class="text-right mono" style="font-weight:700">${fmtWhole(grandTotal)}</td>`;body.appendChild(totTr);document.getElementById('sov-grand-total').textContent=fmtWhole(grandTotal);const bc=document.getElementById('sov-balance-check');if(contract>0){const d=grandTotal-Math.round(contract);if(d===0)bc.innerHTML='<span style="color:var(--green-600)">âœ” Balanced â€” matches contract amount</span>';else bc.innerHTML=`<span style="color:var(--red-600)">âš  Off by ${fmtWhole(Math.abs(d))} from contract amount</span>`}else bc.innerHTML=''}
function resetSOV(){sovMiscItems=[];sovElevations=[{name:'Elevation 1',lf:0}];sovSplits=[{id:'scaffold',label:'Scaffolding',pct:20,color:'scaffold',core:true,included:true},{id:'lath',label:'Lath',pct:30,color:'lath',core:true,included:true},{id:'scratch',label:'Scratch',pct:15,color:'scratch',core:true,included:true},{id:'brown',label:'Brown',pct:20,color:'brown',core:true,included:true},{id:'finish',label:'Finish',pct:15,color:'finish',core:true,included:true}];sovCustomSplits=[];sovCustomCounter=0;const ci=document.getElementById('sov-contract');if(ci){ci.value='';ci.dataset.raw=''}renderSovSplits();renderSovMisc();renderSovElevations();calcSOV();stateChanged()}
</script></body></html>
